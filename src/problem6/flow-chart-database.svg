<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="700" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">Anti-Fraud Detection Flow</text>
  
  <!-- Security Pipeline Box -->
  <rect x="50" y="50" width="700" height="40" fill="#ffebee" stroke="#b71c1c" stroke-width="2"/>
  <text x="400" y="75" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">SECURITY VALIDATION PIPELINE</text>
  
  <!-- Incoming Request -->
  <text x="400" y="110" text-anchor="middle" font-family="Arial" font-size="12">Incoming Request</text>
  <line x1="400" y1="115" x2="400" y2="130" stroke="#666" stroke-width="2"/>
  
  <!-- Step 1 -->
  <rect x="300" y="130" width="200" height="40" fill="#e1f5fe" stroke="#01579b" stroke-width="2"/>
  <text x="400" y="150" text-anchor="middle" font-family="Arial" font-size="12">Step 1: JWT Validation</text>
  
  <!-- Decision 1 -->
  <line x1="400" y1="170" x2="400" y2="190" stroke="#666" stroke-width="2"/>
  <text x="400" y="185" text-anchor="middle" font-family="Arial" font-size="10">Valid?</text>
  
  <!-- No path 1 -->
  <path d="M400 190 L400 210 L500 210 L500 230" stroke="#666" stroke-width="2" fill="none"/>
  <text x="450" y="220" text-anchor="middle" font-family="Arial" font-size="10">No</text>
  <rect x="450" y="230" width="100" height="30" fill="#ffcdd2" stroke="#b71c1c" stroke-width="1"/>
  <text x="500" y="248" text-anchor="middle" font-family="Arial" font-size="10">[401 Unauthorized]</text>
  
  <!-- Yes path 1 -->
  <path d="M400 190 L400 210 L300 210 L300 250" stroke="#666" stroke-width="2" fill="none"/>
  <text x="350" y="230" text-anchor="middle" font-family="Arial" font-size="10">Yes</text>
  <text x="300" y="265" text-anchor="middle" font-family="Arial" font-size="10">[Continue]</text>
  
  <!-- Step 2 -->
  <rect x="300" y="280" width="200" height="40" fill="#e1f5fe" stroke="#01579b" stroke-width="2"/>
  <text x="400" y="300" text-anchor="middle" font-family="Arial" font-size="12">Step 2: Action Token Validation</text>
  
  <!-- Decision 2 -->
  <line x1="400" y1="320" x2="400" y2="340" stroke="#666" stroke-width="2"/>
  <text x="400" y="335" text-anchor="middle" font-family="Arial" font-size="10">Valid?</text>
  
  <!-- No path 2 -->
  <path d="M400 340 L400 360 L500 360 L500 380" stroke="#666" stroke-width="2" fill="none"/>
  <text x="450" y="370" text-anchor="middle" font-family="Arial" font-size="10">No</text>
  <rect x="450" y="380" width="100" height="30" fill="#ffcdd2" stroke="#b71c1c" stroke-width="1"/>
  <text x="500" y="398" text-anchor="middle" font-family="Arial" font-size="10">[400 Invalid Action Token]</text>
  
  <!-- Yes path 2 -->
  <path d="M400 340 L400 360 L300 360 L300 400" stroke="#666" stroke-width="2" fill="none"/>
  <text x="350" y="380" text-anchor="middle" font-family="Arial" font-size="10">Yes</text>
  <text x="300" y="415" text-anchor="middle" font-family="Arial" font-size="10">[Continue]</text>
  
  <!-- Step 3 -->
  <rect x="300" y="430" width="200" height="40" fill="#e1f5fe" stroke="#01579b" stroke-width="2"/>
  <text x="400" y="450" text-anchor="middle" font-family="Arial" font-size="12">Step 3: Rate Limiting Check</text>
  
  <!-- Decision 3 -->
  <line x1="400" y1="470" x2="400" y2="490" stroke="#666" stroke-width="2"/>
  <text x="400" y="485" text-anchor="middle" font-family="Arial" font-size="10">Exceeded?</text>
  
  <!-- No path 3 -->
  <path d="M400 490 L400 510 L300 510 L300 550" stroke="#666" stroke-width="2" fill="none"/>
  <text x="350" y="530" text-anchor="middle" font-family="Arial" font-size="10">No</text>
  <text x="300" y="565" text-anchor="middle" font-family="Arial" font-size="10">[Continue]</text>
  
  <!-- Yes path 3 -->
  <path d="M400 490 L400 510 L500 510 L500 530" stroke="#666" stroke-width="2" fill="none"/>
  <text x="450" y="520" text-anchor="middle" font-family="Arial" font-size="10">Yes</text>
  <rect x="450" y="530" width="100" height="30" fill="#ffcdd2" stroke="#b71c1c" stroke-width="1"/>
  <text x="500" y="548" text-anchor="middle" font-family="Arial" font-size="10">[429 Rate Limit Exceeded]</text>
  
  <!-- Step 4 -->
  <rect x="300" y="580" width="200" height="40" fill="#e1f5fe" stroke="#01579b" stroke-width="2"/>
  <text x="400" y="600" text-anchor="middle" font-family="Arial" font-size="12">Step 4: Score Increment Validation</text>
  
  <!-- Decision 4 -->
  <line x1="400" y1="620" x2="400" y2="640" stroke="#666" stroke-width="2"/>
  <text x="400" y="635" text-anchor="middle" font-family="Arial" font-size="10">Valid?</text>
  
  <!-- No path 4 -->
  <path d="M400 640 L400 660 L500 660 L500 680" stroke="#666" stroke-width="2" fill="none"/>
  <text x="450" y="670" text-anchor="middle" font-family="Arial" font-size="10">No</text>
  <rect x="450" y="680" width="100" height="30" fill="#ffcdd2" stroke="#b71c1c" stroke-width="1"/>
  <text x="500" y="698" text-anchor="middle" font-family="Arial" font-size="10">[400 Invalid Score Increment]</text>
  
  <!-- Yes path 4 -->
  <path d="M400 640 L400 660 L300 660 L300 700" stroke="#666" stroke-width="2" fill="none"/>
  <text x="350" y="680" text-anchor="middle" font-family="Arial" font-size="10">Yes</text>
  <text x="300" y="715" text-anchor="middle" font-family="Arial" font-size="10">[Continue]</text>
  
  <!-- Fraud Detection Rules -->
  <rect x="50" y="550" width="200" height="120" fill="#f5f5f5" stroke="#666" stroke-width="1"/>
  <text x="150" y="570" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Fraud Detection Rules</text>
  
  <text x="60" y="600" text-anchor="start" font-family="Arial" font-size="10">• Max score updates per minute/hour</text>
  <text x="60" y="620" text-anchor="start" font-family="Arial" font-size="10">• Score increment within expected range</text>
  <text x="60" y="640" text-anchor="start" font-family="Arial" font-size="10">• Time drift between client/server < 5s</text>
  <text x="60" y="660" text-anchor="start" font-family="Arial" font-size="10">• Action completion time meets minimum</text>
</svg>